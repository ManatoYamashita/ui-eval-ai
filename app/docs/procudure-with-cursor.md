# AI開発パートナーとの協力ワークフロー

このガイドは、AI Design Feedback Appを**AIアシスタント(Cursor)と協力して開発する**際の具体的な手順です。

---

## 🚀 開発セッション開始前の準備

### 1. 環境準備チェックリスト
```bash
□ Node.js (v18以上) インストール済み
□ VSCode または好みのエディタ準備完了
□ Git リポジトリ作成済み
□ 必要なAPIキー取得済み:
  - Supabase API Key
  - Anthropic API Key  
  - OpenAI API Key
□ リファレンスドキュメント手元に準備
```

### 2. 新しいAIセッション開始時の定型プロンプト

```
以下のプロジェクトの開発を一緒に進めます。
まず添付のリファレンスドキュメントを確認し、理解したことを簡潔に要約してください。

【プロジェクト】
UI evaluation AI - 画像アップロード型のデザイン分析ツール

【現在の状況】
[例: Phase 1の開始 / Phase 2の途中 / 特定機能の実装等]

【今回の目標】
[例: Next.jsプロジェクトの初期化 / RAGシステムの構築 / UI改善等]

理解確認後、具体的な実装手順を提案してください。
```

---

## 📋 フェーズ別実装手順

### Phase 1: プロジェクト基盤構築（Day 1-2）

#### 1-1. プロジェクト初期化
**あなたの指示:**
```
リファレンスドキュメントのPhase 1に従って、
Next.jsプロジェクトを初期化してください。
技術スタック通りに設定し、package.jsonも作成してください。
```

**期待されるAIの対応:**
- `npx create-next-app`コマンドの実行指示
- 必要パッケージのインストールコマンド
- tsconfig.json、tailwind.config.js等の設定

#### 1-2. 基本ファイル構造作成
**あなたの指示:**
```
リファレンスドキュメントのプロジェクト構造に従って、
以下のファイルを作成してください：
- app/components/ui/FileUpload.tsx
- app/lib/supabase.ts
- app/types/analysis.ts

各ファイルには基本的な型定義とインターフェースを含めてください。
```

#### 1-3. 環境変数設定
**あなたの指示:**
```
.env.local.exampleファイルを作成し、
必要な環境変数をリファレンスドキュメント通りに定義してください。
セキュリティベストプラクティスも含めて説明してください。
```

### Phase 2: データベース・RAGシステム構築（Day 3-4）

#### 2-1. Supabaseセットアップ
**あなたの指示:**
```
リファレンスドキュメントのデータベース設計セクションに従って、
Supabaseのテーブル作成SQLとインデックス作成SQLを生成してください。
pgvector拡張の有効化手順も含めてください。
```

#### 2-2. ハイブリッド検索関数実装
**あなたの指示:**
```
リファレンスドキュメントのhybrid_search関数を実装してください。
日本語全文検索とベクトル検索を組み合わせた関数で、
パフォーマンスも考慮した実装をお願いします。
```

#### 2-3. 知識ベース構築スクリプト
**あなたの指示:**
```
WCAG、Apple HIG、Refactoring UIのガイドラインデータを
Supabaseに投入するスクリプト(setup-knowledge-base.ts)を作成してください。
OpenAI Embeddingsを使ったベクトル化も含めてください。
```

### Phase 3: AI分析システム実装（Day 5-6）

#### 3-1. 画像分析パイプライン
**あなたの指示:**
```
リファレンスドキュメントの段階的分析プロセスに従って、
以下の機能を実装してください：
1. preprocessImage関数 - 画像の前処理
2. identifyDesignElements関数 - UI要素の識別  
3. searchRelevantGuidelines関数 - RAG検索

各関数の型定義も含めてください。
```

#### 3-2. メイン分析API
**あなたの指示:**
```
app/api/analyze/route.tsを実装してください。
リファレンスドキュメントのAPI設計に従って、
- リクエスト/レスポンスの型安全性
- 適切なエラーハンドリング
- Claude APIとの統合
を含めた完全な実装をお願いします。
```

### Phase 4: UI/UX改善・最適化（Day 7）

#### 4-1. 分析結果表示UI
**あなたの指示:**
```
app/components/ui/AnalysisResult.tsxを実装してください。
リファレンスドキュメントのレスポンス形式に対応し、
- 改善提案の優先度別表示
- TailwindCSSコード例のシンタックスハイライト
- ガイドライン引用の適切な表示
を含む見やすいUIにしてください。
```

---

## 🔍 品質チェックの進め方

### コード品質確認
**あなたの指示:**
```
作成されたコードをリファレンスドキュメントの品質基準と照らし合わせて確認してください：
- TypeScript型安全性
- エラーハンドリングの完全性
- セキュリティ考慮事項
- パフォーマンス最適化

問題があれば修正案を提案してください。
```

### 機能動作確認
**あなたの指示:**
```
実装した機能のテストケースを作成してください。
以下の観点でテストシナリオを提案してください：
- 正常系の動作確認
- エラーケースの処理
- エッジケースの対応
- ユーザビリティ確認
```

---

## 🐛 問題発生時の対処法

### エラー発生時
**あなたの指示:**
```
以下のエラーが発生しました：
[エラーメッセージを貼り付け]

リファレンスドキュメントのトラブルシューティングセクションを参考に、
原因の特定と解決策を提案してください。
```

### 仕様の曖昧さが発覚した場合
**あなたの指示:**
```
[具体的な曖昧な点] について、
リファレンスドキュメントに明確な記載がありません。
業界ベストプラクティスに基づいて実装案を提案し、
ドキュメントの更新も含めて提案してください。
```

---

## 📝 セッション終了時の手順

### 進捗の記録
**あなたの指示:**
```
今回のセッションで実装した内容をまとめてください：
- 完了した機能
- 残っている課題
- 学んだ知見
- 次回セッションで取り組むべき項目

リファレンスドキュメントの開発ログセクションに追記する形式で出力してください。
```

### ドキュメント更新
**あなたの指示:**
```
今回の実装で判明した追加情報や変更点を
リファレンスドキュメントに反映してください。
特に以下の観点で更新をお願いします：
- 実装時に発見した最適化ポイント
- エラー対処法の追加
- より良い実装パターンの発見
```

---

## 💡 効率的な開発のためのコツ

### 1. 段階的な確認
```
大きな機能を一度に実装せず、小さな単位で確認を繰り返す：

「FileUploadコンポーネントの基本版を作成してください」
↓ 動作確認
「画像プレビュー機能を追加してください」  
↓ 動作確認
「バリデーション機能を追加してください」
```

### 2. 具体的な指示
```
❌ 悪い例: 「AIの分析機能を作ってください」
✅ 良い例: 「Claude 3.5 Haiku APIを使って、画像から UI要素を識別する
identifyDesignElements関数を作成してください。
返り値はElementAnalysis型で、リファレンスドキュメントの
型定義に従ってください」
```

### 3. エラーの詳細共有
```
エラーが発生した場合は以下を含めて報告：
- 正確なエラーメッセージ
- 実行したコマンドまたは操作
- 実行環境（OS、Node.jsバージョン等）
- 期待していた動作
```

---

## 🎯 各フェーズの完了基準

### Phase 1完了の確認
```
以下を確認して、Phase 1完了を確認してください：
□ Next.jsプロジェクトが正常に起動する
□ 基本的なFileUploadコンポーネントが表示される
□ TypeScriptエラーが0件
□ 環境変数が適切に設定されている
```

### Phase 2完了の確認  
```
以下を確認して、Phase 2完了を確認してください：
□ Supabaseデータベースが正常に作成されている
□ hybrid_search関数が動作する
□ 知識ベースにガイドラインデータが投入されている
□ ベクトル検索が正常に実行される
```

### Phase 3完了の確認
```
以下を確認して、Phase 3完了を確認してください：
□ /api/analyzeエンドポイントが正常にレスポンスを返す
□ 画像アップロードからAI分析まで一貫して動作する
□ RAG検索が適切なガイドラインを取得している
□ Claude APIからの回答が構造化されている
```

---

## 🔄 次回セッション引き継ぎテンプレート

```
次回のAIセッション開始時に使用するテンプレート：

---
前回セッションの続きから開発を進めます。

【プロジェクト】AI Design Feedback App
【前回完了項目】
- [完了した機能リスト]

【今回の開始状況】
- [現在の状況]
- [残っている課題]

【今回の目標】
- [今回完了したい項目]

添付のリファレンスドキュメントを確認し、
前回からの継続として開発を進めてください。
---
```

---

このワークフローに従うことで、**効率的かつ高品質な開発**をAIアシスタントと協力して進めることができます。重要なのは、**小さな単位で確認を繰り返し**、**リファレンスドキュメントを常に参照する**ことです。